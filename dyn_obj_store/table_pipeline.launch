<launch>
  <param name="global_frame_id" value="/base_link" />	
  <!-- NormalEstimation -->
  <node pkg="point_cloud_mapping" type="normal_estimation_node" name="normal_estimation_node" output="screen">
    <param name="~search_k_closest" value="30" />
    <param name="~downsample" value="0" />
    <remap from="~tilt_laser_cloud" to="/cloud_pcd"/>
    <remap from="~cloud_normals" to="/cloud_pcd_normals"/>
  </node>
  
  <!-- Box Filter -->
  <node pkg="dyn_obj_store" type="box_filter" name="box_filter" output="screen">
    <!--<param name="input_cloud_topic" value="/cloud_pcd_normals" />-->
    <param name="input_cloud_topic" value="/cloud_pcd" />
    <param name="output_cloud_topic" value="/shoulder_cloud_clipped" />
    <param name="box_min_y" value="-4.0" />
  </node>
  
  <!-- Wall Filter 
  <node pkg="dyn_obj_store" type="wall_filter" name="wall_filter" output="screen">
    <param name="input_cloud_topic" value="/shoulder_cloud_clipped" />
    <param name="output_cloud_topic" value="/shoulder_cloud_no_walls" />
  </node>
 --> 
  <!-- Table Object Detector (passive version) -->
  <node pkg="dyn_obj_store" type="table_object_detector_passive_node" name="table_object_detector_passive" output="screen">
    <param name="input_cloud_topic" value="/shoulder_cloud_clipped" />
    <param name="output_table_topic" value="/table_with_objects" />
    <param name="sac_distance_threshold" value="0.015" />
    <param name="normal_eps_angle" value="5" />
  </node>
  
  <!-- Table Memory -->
  <node pkg="dyn_obj_store" type="table_memory" name="table_memory" output="screen">
    <param name="input_table_topic" value="/table_with_objects" />
  </node>
  
  <!-- Table Message Splitter -->
  <node pkg="dyn_obj_store" type="table_msg_split" name="table_msg_split" output="screen">
    <param name="input_table_topic" value="/table_with_objects" />
    <param name="output_pcds_topic" value="/table_objects" />
    <param name="output_polygon_topic" value="/table_polygon" />
  </node>

</launch>

